# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-14
**Status:** SHIPPED

---

# Requirements: Claim Service

**Defined:** 2026-02-14
**Core Value:** Curators can paste any source text and get back a clean table of topic-organized, self-contained claims ready for the Geo knowledge graph.

## v1 Requirements

All v1 requirements shipped with v1.0 MVP.

### Extraction

- [x] **EXTR-01**: Service extracts topics from source text using Gemini structured outputs (TopicResult Pydantic schema)
- [x] **EXTR-02**: Service extracts claims mapped to extracted topics using Gemini structured outputs (ClaimWithTopicResult Pydantic schema)
- [x] **EXTR-03**: Claims are self-contained and atomic — no pronouns, no dangling references, one fact per claim (5-32 words)
- [x] **EXTR-04**: Claims use attribution stripping — extract facts directly, not "Dr. X said that..."
- [x] **EXTR-05**: Prompts are adapted from extraction-api premium pipeline for generic source text (not podcast-specific)

### API

- [x] **API-01**: `POST /generate/claims` endpoint accepts `{ "source_text": string }` and returns claims
- [x] **API-02**: Response format is `{ "claims": [{ "claim_topic": string, "claim": string }] }`
- [x] **API-03**: Input validation rejects empty, whitespace-only, too-short, and too-long source text with clear error messages
- [x] **API-04**: Errors propagate as typed exceptions with appropriate HTTP status codes — no silent empty returns on LLM failures
- [x] **API-05**: Gemini calls retry with exponential backoff on 429/503 errors
- [x] **API-06**: `GET /health` endpoint returns `{ "status": "ok" }` without LLM dependency
- [x] **API-07**: Gemini safety settings configured to `BLOCK_NONE` to handle political/health/violence content

### Frontend

- [x] **UI-01**: Plain HTML/JS page served by FastAPI with textarea input for source text
- [x] **UI-02**: Generate button triggers `POST /generate/claims` and renders results
- [x] **UI-03**: Results displayed as table with columns `claim_topic` and `claim`
- [x] **UI-04**: User can export results table as CSV file
- [x] **UI-05**: Loading indicator visible during extraction with button disabled to prevent double-submission

### Infrastructure

- [x] **INFR-01**: Dockerfile using python:3.12-slim base with UV for Railway deployment
- [x] **INFR-02**: `railway.toml` with Dockerfile builder, health check, and start command
- [x] **INFR-03**: `.env.example` with GEMINI_API_KEY, GEMINI_MODEL, GEMINI_TEMPERATURE, PORT
- [x] **INFR-04**: Pydantic BaseSettings loads configuration from environment variables and `.env` file
- [x] **INFR-05**: Ruff configured for linting and formatting in `pyproject.toml`
- [x] **INFR-06**: mypy configured with `strict = true` in `pyproject.toml`
- [x] **INFR-07**: pytest test suite with async support via pytest-asyncio

## v2 Requirements

Deferred to future release.

### Polish

- **PLSH-01**: Copy-to-clipboard button per claim row in results table
- **PLSH-02**: Optional `source_type` field in API request (news, research, literature) for prompt tuning
- **PLSH-03**: Configurable minimum claims threshold per topic (filter low-signal topics)
- **PLSH-04**: JSON export alongside CSV

### Scale

- **SCAL-01**: API rate limiting middleware to prevent Gemini quota exhaustion
- **SCAL-02**: In-memory LRU cache for repeated extractions of the same text

## Out of Scope

| Feature | Reason |
|---------|--------|
| Database / persistence | Stateless service — claims go into Geo knowledge graph, not this service |
| Authentication | Security handled at infrastructure level per project constraints |
| Key takeaway extraction | Curators decide importance — AI judgment adds unnecessary step |
| Quote finding / entailment validation | Podcast-specific features, curators have source text for reference |
| Real-time streaming | Gemini structured outputs return complete response — no partial JSON streaming |
| Deduplication | Single-text stateless extraction — no cross-session duplicates possible |
| DSPy pipeline | Direct Gemini API with structured outputs is simpler and proven |
| Batch processing | Curators work one text at a time — batch adds unnecessary complexity |
| Custom prompt editing in UI | Non-technical curators should not edit LLM prompts |
| Multi-language support | English-language curators — defer to separate milestone if needed |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| EXTR-01 | Phase 1 | Shipped v1.0 |
| EXTR-02 | Phase 1 | Shipped v1.0 |
| EXTR-03 | Phase 1 | Shipped v1.0 |
| EXTR-04 | Phase 1 | Shipped v1.0 |
| EXTR-05 | Phase 1 | Shipped v1.0 |
| API-01 | Phase 1 | Shipped v1.0 |
| API-02 | Phase 1 | Shipped v1.0 |
| API-03 | Phase 1 | Shipped v1.0 |
| API-04 | Phase 1 | Shipped v1.0 |
| API-05 | Phase 1 | Shipped v1.0 |
| API-06 | Phase 1 | Shipped v1.0 |
| API-07 | Phase 1 | Shipped v1.0 |
| UI-01 | Phase 2 | Shipped v1.0 |
| UI-02 | Phase 2 | Shipped v1.0 |
| UI-03 | Phase 2 | Shipped v1.0 |
| UI-04 | Phase 2 | Shipped v1.0 |
| UI-05 | Phase 2 | Shipped v1.0 |
| INFR-01 | Phase 3 | Shipped v1.0 |
| INFR-02 | Phase 3 | Shipped v1.0 |
| INFR-03 | Phase 1 | Shipped v1.0 |
| INFR-04 | Phase 1 | Shipped v1.0 |
| INFR-05 | Phase 1 | Shipped v1.0 |
| INFR-06 | Phase 1 | Shipped v1.0 |
| INFR-07 | Phase 1 | Shipped v1.0 |

**Coverage:**
- v1 requirements: 24 total
- Shipped: 24
- Remaining: 0

---
*Requirements defined: 2026-02-14*
*Archived: 2026-02-14 after v1.0 MVP milestone*
